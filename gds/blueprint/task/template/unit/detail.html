{% extends "base.html" %}
{% block precss %}
    <style type="text/css">
    </style>
{% endblock %}
{% block prejs %}
    <script type="text/javascript">
        function save(){
            $.ajax({
                url:location.href,
                type:'post',
                data:delnull({
                    extra:$("#extra").val(),
                    // dmid:$("#dmid").val(),
                }),
                async:false,
                dataType:'json',
                success:function(data){
                    location.href=location.href.substring(0, location.href.indexOf('detail')) + 'list';
                },
                error:function(XMLHttpRequest, status, thrown){
                    ;
                }
            });
        }
        function reset(){
            $("#unit_name").val("");
            $("#extra").val("");
            $("#datamodel_name").val("");
        }
    </script>
{% endblock %}
{% block content %}
    <div class="ui sizer vertical segment" style="font-size: 20px; text-align: center;">
        <div class="ui large header">脚本业务分类</div>
    </div>
    <div class="ui input" style="width:100%; margin:15px 20px;">
        <span >分类名称:&nbsp;&nbsp;</span><span>{{unit['unit_name']}}</span>
    </div>
    <div class="ui input" style="width:100%; margin:15px 20px;">
        <span>分类描述:&nbsp;&nbsp;</span><input id="extra" type="text" style="width:60%;" value="{{unit['extra']|default('', true)}}">
    </div>
    <div class="ui input" style="width:100%; margin:15px 20px;">
        <span>分类文件路径:&nbsp;&nbsp;</span><span>{{unit['filepath']}}</span>
    </div>
    <div class="ui input" style="width:100%; margin:15px 20px;">
        <span>分类文件路径是否更新:&nbsp;&nbsp;</span><span>{{unit['fileupdate']}}</span>
    </div>
    <div class="ui input" style="width:100%; margin:15px 20px;">
        <span>分类数据模型:&nbsp;&nbsp;</span>
        <div class="ui selection dropdown" tabindex="0">
            <input type="hidden" id="dmid" value="{{unit['dmid']}}">
            <i class="dropdown icon"></i>
            <div class="default text">{{unit['datamodel_name']}}</div>
            <div class="menu">
                {% for one in datamodels %}
                    <div class="item" data-value="{{one['_id']}}">{{one['name']}}</div>
                {% endfor %}
            </div>
        </div>
    </div>
    <button class="ui primary button" onclick="save()">保存</button>
    <button class="ui button" onclick="reset()">重置</button>
    {% if not unit['_id'] == '' %}
        <a href="/gds/p/article/list/{{unit['_id']}}">脚本数据源列表</a>
    {% endif %}
{% endblock %}
{% block postjs %}
    <script type="text/javascript">
        $('.ui.dropdown').dropdown();
    </script>
{% endblock %}